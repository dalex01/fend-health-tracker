var app=app||{};!function(){"use strict";app.SearchItemModel=Backbone.Model.extend({defaults:{brand_id:0,brand_name:"",item_id:0,item_name:"",calories:0,date:null}})}();
var app=app||{};!function(){"use strict";app.ResultsItemModel=Backbone.Model.extend({defaults:{brand_id:0,brand_name:"",item_id:0,item_name:"",calories:0,date:null}})}();
var app=app||{};!function(){"use strict";var e=Backbone.Collection.extend({model:app.SearchItemModel,localStorage:new Backbone.LocalStorage("searchcalories-backbone")});app.searchItemsCollection=new e}();
var app=app||{};!function(){"use strict";var e=Backbone.Collection.extend({model:app.ResultsItemModel,localStorage:new Backbone.LocalStorage("resultscalories-backbone"),calculateTotal:function(){var e=0;return this.each(function(a){e+=a.get("calories")}),e}});app.resultsItemsCollection=new e}();
var app=app||{};!function(e){"use strict";app.SearchItemView=Backbone.View.extend({tagName:"li",template:_.template(e("#searchitem-template").html()),events:{"click .view":"addProduct"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},addProduct:function(){app.resultsItemsCollection.create({item_id:this.model.get("item_id"),item_name:this.model.get("item_name"),brand_id:this.model.get("brand_id"),brand_name:this.model.get("brand_name"),calories:this.model.get("calories"),date:this.model.get("date")}),app.searchItemsCollection.reset()}})}(jQuery);
var app=app||{};!function(t){"use strict";app.ResultsItemView=Backbone.View.extend({tagName:"li",template:_.template(t("#productitem-template").html()),events:{"click .destroy":"clear"},initialize:function(){this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},clear:function(){this.model.destroy()}})}(jQuery);
var app=app||{};!function(e){"use strict";app.SearchView=Backbone.View.extend({el:e("#search"),events:{"keyup #new-search":"keyPressedInSearch"},initialize:function(){this.$search=e("#new-search"),this.$searchMain=this.$("#searchMain"),this.$searchResults=this.$("#searchResults"),this.$list=e("#search-list"),this.$loading=e("#loading"),this.listenTo(app.searchItemsCollection,"add",this.addOne),this.listenTo(app.searchItemsCollection,"reset",this.addAll),this.listenTo(app.searchItemsCollection,"all",this.render)},render:function(){app.searchItemsCollection.length?this.$searchResults.show():this.$searchResults.hide()},addOne:function(e){var s=new app.SearchItemView({model:e});this.$list.append(s.render().el)},addAll:function(){this.$list.html(""),app.searchItemsCollection.each(this.addOne,this)},searchProducts:function(s){var a=this;a.$searchResults.show(),a.$loading.show();var i="https://api.nutritionix.com/v1_1/search/"+s+"?results=0%3A20&cal_min=0&cal_max=20&fields=item_name%2Cbrand_name%2Citem_id%2Cbrand_id%2Cnf_calories&appId=9d3343d7&appKey=4283cbc03da532a49ad58e0048e9418f";e.ajax({url:i,dataType:"json",success:function(e){var s=e.hits;if(s.length){for(var i=0;i<s.length;i++)app.searchItemsCollection.create({brand_id:s[i].fields.brand_id,brand_name:s[i].fields.brand_name,item_id:s[i].fields.item_id,item_name:s[i].fields.item_name,calories:s[i].fields.nf_calories,date:Date.now()});a.$loading.hide()}else a.$loading.hide(),a.$searchResults.show(),a.$list.append("<li><div class='view'><label id=\"product\">No results for this query. Try again, please.</label></div></li>")},error:function(e,a,t){alert(e.status+" failed to get Nutritionix resources for search query "+s+"\nUrl requested: \n"+i)}})},keyPressedInSearch:function(e){var s=this.$search.val().trim();e.keyCode===ENTER_KEY&&s?(this.searchProducts(s),this.$search.val("")):e.keyCode===ESC_KEY&&s&&this.$search.val("")}})}(jQuery);
var app=app||{};!function(t){"use strict";app.ResultsView=Backbone.View.extend({el:t("#list"),initialize:function(){this.$list=t("#products-list"),this.$main=t("#main"),this.$total=t("#total"),this.$totalCount=t(".totalCount"),this.listenTo(app.resultsItemsCollection,"add",this.addOne),this.listenTo(app.resultsItemsCollection,"reset",this.addAll),this.listenTo(app.resultsItemsCollection,"all",this.render),this.listenTo(app.resultsItemsCollection,"remove",this.render),app.resultsItemsCollection.fetch({reset:!0})},render:function(){app.resultsItemsCollection.length?(this.$totalCount.html(app.resultsItemsCollection.calculateTotal()),this.$main.show(),this.$total.show()):(this.$main.hide(),this.$total.hide())},addOne:function(t){var e=new app.ResultsItemView({model:t});this.$list.append(e.render().el)},addAll:function(){this.$list.html(""),app.resultsItemsCollection.each(this.addOne,this)}})}(jQuery);

var app=app||{},ENTER_KEY=13,ESC_KEY=27;$(function(){"use strict";new app.SearchView,new app.ResultsView});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlYXJjaEl0ZW0uanMiLCJyZXN1bHRzSXRlbS5qcyIsInNlYXJjaEl0ZW1zLmpzIiwicmVzdWx0c0l0ZW1zLmpzIiwic2VhcmNoSXRlbVZpZXcuanMiLCJyZXN1bHRzSXRlbVZpZXcuanMiLCJzZWFyY2hWaWV3LmpzIiwicmVzdWx0c1ZpZXcuanMiLCJyb3V0ZXIuanMiLCJhcHAuanMiXSwibmFtZXMiOlsiYXBwIiwiU2VhcmNoSXRlbU1vZGVsIiwiQmFja2JvbmUiLCJNb2RlbCIsImV4dGVuZCIsImRlZmF1bHRzIiwiYnJhbmRfaWQiLCJicmFuZF9uYW1lIiwiaXRlbV9pZCIsIml0ZW1fbmFtZSIsImNhbG9yaWVzIiwiZGF0ZSIsIlJlc3VsdHNJdGVtTW9kZWwiLCJTZWFyY2hJdGVtc0NvbGxlY3Rpb24iLCJDb2xsZWN0aW9uIiwibW9kZWwiLCJsb2NhbFN0b3JhZ2UiLCJMb2NhbFN0b3JhZ2UiLCJzZWFyY2hJdGVtc0NvbGxlY3Rpb24iLCJSZXN1bHRzSXRlbXNDb2xsZWN0aW9uIiwiY2FsY3VsYXRlVG90YWwiLCJzdW0iLCJ0aGlzIiwiZWFjaCIsImdldCIsInJlc3VsdHNJdGVtc0NvbGxlY3Rpb24iLCIkIiwiU2VhcmNoSXRlbVZpZXciLCJWaWV3IiwidGFnTmFtZSIsInRlbXBsYXRlIiwiXyIsImh0bWwiLCJldmVudHMiLCJjbGljayAudmlldyIsInJlbmRlciIsIiRlbCIsInRvSlNPTiIsImFkZFByb2R1Y3QiLCJjcmVhdGUiLCJyZXNldCIsImpRdWVyeSIsIlJlc3VsdHNJdGVtVmlldyIsImNsaWNrIC5kZXN0cm95IiwiaW5pdGlhbGl6ZSIsImxpc3RlblRvIiwicmVtb3ZlIiwiY2xlYXIiLCJkZXN0cm95IiwiU2VhcmNoVmlldyIsImVsIiwia2V5dXAgI25ldy1zZWFyY2giLCIkc2VhcmNoIiwiJHNlYXJjaE1haW4iLCIkc2VhcmNoUmVzdWx0cyIsIiRsaXN0IiwiJGxvYWRpbmciLCJhZGRPbmUiLCJhZGRBbGwiLCJsZW5ndGgiLCJzaG93IiwiaGlkZSIsIml0ZW0iLCJ2aWV3IiwiYXBwZW5kIiwic2VhcmNoUHJvZHVjdHMiLCJlIiwic2VsZiIsInVybCIsImFqYXgiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsInByQXJyYXkiLCJoaXRzIiwiZmllbGRzIiwibmZfY2Fsb3JpZXMiLCJEYXRlIiwibm93IiwiZXJyb3IiLCJ4aHIiLCJhamF4T3B0aW9ucyIsInRocm93bkVycm9yIiwiYWxlcnQiLCJzdGF0dXMiLCJrZXlQcmVzc2VkSW5TZWFyY2giLCJzZWFyY2hRdWVyeSIsInZhbCIsInRyaW0iLCJrZXlDb2RlIiwiRU5URVJfS0VZIiwiRVNDX0tFWSIsIlJlc3VsdHNWaWV3IiwiJG1haW4iLCIkdG90YWwiLCIkdG90YWxDb3VudCIsImZldGNoIl0sIm1hcHBpbmdzIjoiQUFDQSxHQUFJQSxLQUFNQSxTQUVWLFdBQ0MsWUFNQUEsS0FBSUMsZ0JBQWtCQyxTQUFTQyxNQUFNQyxRQUVwQ0MsVUFDQ0MsU0FBVSxFQUNWQyxXQUFZLEdBQ1pDLFFBQVMsRUFDVEMsVUFBVyxHQUNYQyxTQUFVLEVBQ1ZDLEtBQU07QUNqQlQsR0FBSVgsS0FBTUEsU0FFVixXQUNDLFlBTUFBLEtBQUlZLGlCQUFtQlYsU0FBU0MsTUFBTUMsUUFFckNDLFVBQ0NDLFNBQVUsRUFDVkMsV0FBWSxHQUNaQyxRQUFTLEVBQ1RDLFVBQVcsR0FDWEMsU0FBVSxFQUNWQyxLQUFNO0FDakJULEdBQUlYLEtBQU1BLFNBRVYsV0FDQyxZQU1BLElBQUlhLEdBQXdCWCxTQUFTWSxXQUFXVixRQUcvQ1csTUFBT2YsSUFBSUMsZ0JBR1hlLGFBQWMsR0FBSWQsVUFBU2UsYUFBYSw0QkFLekNqQixLQUFJa0Isc0JBQXdCLEdBQUlMO0FDcEJqQyxHQUFJYixLQUFNQSxTQUVWLFdBQ0MsWUFNQSxJQUFJbUIsR0FBeUJqQixTQUFTWSxXQUFXVixRQUdoRFcsTUFBT2YsSUFBSVksaUJBR1hJLGFBQWMsR0FBSWQsVUFBU2UsYUFBYSw0QkFHeENHLGVBQWdCLFdBQ2YsR0FBSUMsR0FBTSxDQUlWLE9BSEFDLE1BQUtDLEtBQUssU0FBU1IsR0FDTk0sR0FBT04sRUFBTVMsSUFBSSxjQUV2QkgsSUFLVHJCLEtBQUl5Qix1QkFBeUIsR0FBSU47QUM1QmxDLEdBQUluQixLQUFNQSxTQUVWLFNBQVcwQixHQUNWLFlBTUExQixLQUFJMkIsZUFBaUJ6QixTQUFTMEIsS0FBS3hCLFFBRWxDeUIsUUFBVSxLQUdWQyxTQUFVQyxFQUFFRCxTQUFTSixFQUFFLHdCQUF3Qk0sUUFHL0NDLFFBQ0NDLGNBQWUsY0FJaEJDLE9BQVEsV0FFUCxNQURBYixNQUFLYyxJQUFJSixLQUFLVixLQUFLUSxTQUFTUixLQUFLUCxNQUFNc0IsV0FDaENmLE1BSVJnQixXQUFZLFdBQ1h0QyxJQUFJeUIsdUJBQXVCYyxRQUMxQi9CLFFBQVNjLEtBQUtQLE1BQU1TLElBQUksV0FDeEJmLFVBQVdhLEtBQUtQLE1BQU1TLElBQUksYUFDMUJsQixTQUFVZ0IsS0FBS1AsTUFBTVMsSUFBSSxZQUN6QmpCLFdBQVllLEtBQUtQLE1BQU1TLElBQUksY0FDM0JkLFNBQVVZLEtBQUtQLE1BQU1TLElBQUksWUFDekJiLEtBQU1XLEtBQUtQLE1BQU1TLElBQUksVUFFdEJ4QixJQUFJa0Isc0JBQXNCc0IsWUFJMUJDO0FDekNILEdBQUl6QyxLQUFNQSxTQUVWLFNBQVcwQixHQUNWLFlBTUExQixLQUFJMEMsZ0JBQWtCeEMsU0FBUzBCLEtBQUt4QixRQUVuQ3lCLFFBQVUsS0FHVkMsU0FBVUMsRUFBRUQsU0FBU0osRUFBRSx5QkFBeUJNLFFBR2hEQyxRQUNDVSxpQkFBa0IsU0FJbkJDLFdBQVksV0FDWHRCLEtBQUt1QixTQUFTdkIsS0FBS1AsTUFBTyxVQUFXTyxLQUFLd0IsU0FJM0NYLE9BQVEsV0FFUCxNQURBYixNQUFLYyxJQUFJSixLQUFLVixLQUFLUSxTQUFTUixLQUFLUCxNQUFNc0IsV0FDaENmLE1BSVJ5QixNQUFPLFdBQ056QixLQUFLUCxNQUFNaUMsY0FJWFA7QUN0Q0gsR0FBSXpDLEtBQU1BLFNBRVYsU0FBVzBCLEdBQ1YsWUFNQTFCLEtBQUlpRCxXQUFhL0MsU0FBUzBCLEtBQUt4QixRQUUzQjhDLEdBQUl4QixFQUFFLFdBR05PLFFBQ0lrQixvQkFBcUIsc0JBSzVCUCxXQUFZLFdBQ1h0QixLQUFLOEIsUUFBVTFCLEVBQUUsZUFDakJKLEtBQUsrQixZQUFjL0IsS0FBS0ksRUFBRSxlQUMxQkosS0FBS2dDLGVBQWlCaEMsS0FBS0ksRUFBRSxrQkFDN0JKLEtBQUtpQyxNQUFRN0IsRUFBRSxnQkFDZkosS0FBS2tDLFNBQVc5QixFQUFFLFlBRWxCSixLQUFLdUIsU0FBUzdDLElBQUlrQixzQkFBdUIsTUFBT0ksS0FBS21DLFFBQ3JEbkMsS0FBS3VCLFNBQVM3QyxJQUFJa0Isc0JBQXVCLFFBQVNJLEtBQUtvQyxRQUN2RHBDLEtBQUt1QixTQUFTN0MsSUFBSWtCLHNCQUF1QixNQUFPSSxLQUFLYSxTQUl0REEsT0FBUSxXQUNIbkMsSUFBSWtCLHNCQUFzQnlDLE9BQzdCckMsS0FBS2dDLGVBQWVNLE9BRXBCdEMsS0FBS2dDLGVBQWVPLFFBTXRCSixPQUFRLFNBQVVLLEdBQ2pCLEdBQUlDLEdBQU8sR0FBSS9ELEtBQUkyQixnQkFBaUJaLE1BQU8rQyxHQUMzQ3hDLE1BQUtpQyxNQUFNUyxPQUFPRCxFQUFLNUIsU0FBU2UsS0FJakNRLE9BQVEsV0FDUHBDLEtBQUtpQyxNQUFNdkIsS0FBSyxJQUNoQmhDLElBQUlrQixzQkFBc0JLLEtBQUtELEtBQUttQyxPQUFRbkMsT0FJN0MyQyxlQUFnQixTQUFVQyxHQUV6QixHQUFJQyxHQUFPN0MsSUFFUjZDLEdBQUtiLGVBQWVNLE9BQ3BCTyxFQUFLWCxTQUFTSSxNQUVqQixJQUFJUSxHQUFNLDJDQUE2Q0YsRUFBSSw4SkFDM0R4QyxHQUFFMkMsTUFDS0QsSUFBS0EsRUFDTEUsU0FBVSxPQUNWQyxRQUFTLFNBQVNDLEdBQ2pCLEdBQUlDLEdBQVVELEVBQVNFLElBRXZCLElBQUlELEVBQVFkLE9BQVEsQ0FDbkIsSUFBSyxHQUFJRyxHQUFPLEVBQUdBLEVBQU9XLEVBQVFkLE9BQVFHLElBQy9DOUQsSUFBSWtCLHNCQUFzQnFCLFFBQ3pCakMsU0FBVW1FLEVBQVFYLEdBQU1hLE9BQU9yRSxTQUN6QkMsV0FBWWtFLEVBQVFYLEdBQU1hLE9BQU9wRSxXQUNqQ0MsUUFBU2lFLEVBQVFYLEdBQU1hLE9BQU9uRSxRQUM5QkMsVUFBV2dFLEVBQVFYLEdBQU1hLE9BQU9sRSxVQUNoQ0MsU0FBVStELEVBQVFYLEdBQU1hLE9BQU9DLFlBQy9CakUsS0FBTWtFLEtBQUtDLE9BSW5CWCxHQUFLWCxTQUFTSyxXQUlSTSxHQUFLWCxTQUFTSyxPQUVkTSxFQUFLYixlQUFlTSxPQUNwQk8sRUFBS1osTUFBTVMsT0FBTyxpSEFHcEJlLE1BQU8sU0FBVUMsRUFBS0MsRUFBYUMsR0FFbENDLE1BQU1ILEVBQUlJLE9BQVMseURBQTJEbEIsRUFBSSxzQkFBd0JFLE9BTWhIaUIsbUJBQW9CLFNBQVVuQixHQUM3QixHQUFJb0IsR0FBY2hFLEtBQUs4QixRQUFRbUMsTUFBTUMsTUFFOUJ0QixHQUFFdUIsVUFBWUMsV0FBYUosR0FDOUJoRSxLQUFLMkMsZUFBZXFCLEdBQ3BCaEUsS0FBSzhCLFFBQVFtQyxJQUFJLEtBRWJyQixFQUFFdUIsVUFBWUUsU0FBV0wsR0FDbkNoRSxLQUFLOEIsUUFBUW1DLElBQUksUUFLbEI5QztBQ2hISCxHQUFJekMsS0FBTUEsU0FFVixTQUFXMEIsR0FDVixZQU1BMUIsS0FBSTRGLFlBQWMxRixTQUFTMEIsS0FBS3hCLFFBRTVCOEMsR0FBSXhCLEVBQUUsU0FLVGtCLFdBQVksV0FDWHRCLEtBQUtpQyxNQUFRN0IsRUFBRSxrQkFDZkosS0FBS3VFLE1BQVFuRSxFQUFFLFNBQ2ZKLEtBQUt3RSxPQUFTcEUsRUFBRSxVQUNoQkosS0FBS3lFLFlBQWNyRSxFQUFFLGVBRXJCSixLQUFLdUIsU0FBUzdDLElBQUl5Qix1QkFBd0IsTUFBT0gsS0FBS21DLFFBQ3REbkMsS0FBS3VCLFNBQVM3QyxJQUFJeUIsdUJBQXdCLFFBQVNILEtBQUtvQyxRQUN4RHBDLEtBQUt1QixTQUFTN0MsSUFBSXlCLHVCQUF3QixNQUFPSCxLQUFLYSxRQUN0RGIsS0FBS3VCLFNBQVM3QyxJQUFJeUIsdUJBQXdCLFNBQVVILEtBQUthLFFBRXpEbkMsSUFBSXlCLHVCQUF1QnVFLE9BQU94RCxPQUFPLEtBSTFDTCxPQUFRLFdBRUhuQyxJQUFJeUIsdUJBQXVCa0MsUUFDOUJyQyxLQUFLeUUsWUFBWS9ELEtBQUtoQyxJQUFJeUIsdUJBQXVCTCxrQkFDakRFLEtBQUt1RSxNQUFNakMsT0FDWHRDLEtBQUt3RSxPQUFPbEMsU0FHWnRDLEtBQUt1RSxNQUFNaEMsT0FDWHZDLEtBQUt3RSxPQUFPakMsU0FNZEosT0FBUSxTQUFVSyxHQUNqQixHQUFJQyxHQUFPLEdBQUkvRCxLQUFJMEMsaUJBQWtCM0IsTUFBTytDLEdBQzVDeEMsTUFBS2lDLE1BQU1TLE9BQU9ELEVBQUs1QixTQUFTZSxLQUlqQ1EsT0FBUSxXQUNQcEMsS0FBS2lDLE1BQU12QixLQUFLLElBQ2hCaEMsSUFBSXlCLHVCQUF1QkYsS0FBS0QsS0FBS21DLE9BQVFuQyxVQUc3Q21CO0FDMURIO0FDRUEsR0FBSXpDLEtBQU1BLFFBQ04wRixVQUFZLEdBQ1pDLFFBQVUsRUFFZGpFLEdBQUUsV0FDRCxZQUdBLElBQUkxQixLQUFJaUQsV0FDUixHQUFJakQsS0FBSTRGIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qZ2xvYmFsIEJhY2tib25lICovXHJcbnZhciBhcHAgPSBhcHAgfHwge307XHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHJcblx0Ly8gU2VhcmNoIE1vZGVsXHJcblx0Ly8gLS0tLS0tLS0tLS0tXHJcblxyXG5cdC8vIE91ciBiYXNpYyBTZWFyY2ggbW9kZWwgaGFzICdicmFuZF9pZCcsICdicmFuZF9uYW1lJywgJ2l0ZW1faWQnLCAnaXRlbV9uYW1lJyBhbmQgJ2NhbG9yaWVzJyBhdHRyaWJ1dGVzLlxyXG5cdGFwcC5TZWFyY2hJdGVtTW9kZWwgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xyXG5cdFx0Ly8gRGVmYXVsdCBhdHRyaWJ1dGVzIGZvciB0aGUgc2VhcmNoXHJcblx0XHRkZWZhdWx0czoge1xyXG5cdFx0XHRicmFuZF9pZDogMCxcclxuXHRcdFx0YnJhbmRfbmFtZTogJycsXHJcblx0XHRcdGl0ZW1faWQ6IDAsXHJcblx0XHRcdGl0ZW1fbmFtZTogJycsXHJcblx0XHRcdGNhbG9yaWVzOiAwLFxyXG5cdFx0XHRkYXRlOiBudWxsXHJcblx0XHR9LFxyXG5cdH0pO1xyXG59KSgpOyIsIi8qZ2xvYmFsIEJhY2tib25lICovXHJcbnZhciBhcHAgPSBhcHAgfHwge307XHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHJcblx0Ly8gUHJvZHVjdCBNb2RlbFxyXG5cdC8vIC0tLS0tLS0tLS0tLS1cclxuXHJcblx0Ly8gT3VyIGJhc2ljIFNlYXJjaCBtb2RlbCBoYXMgJ2JyYW5kX2lkJywgJ2JyYW5kX25hbWUnLCAnaXRlbV9pZCcsICdpdGVtX25hbWUnIGFuZCAnY2Fsb3JpZXMnIGF0dHJpYnV0ZXMuXHJcblx0YXBwLlJlc3VsdHNJdGVtTW9kZWwgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xyXG5cdFx0Ly8gRGVmYXVsdCBhdHRyaWJ1dGVzIGZvciB0aGUgY2hvc2VuIHByb2R1Y3RcclxuXHRcdGRlZmF1bHRzOiB7XHJcblx0XHRcdGJyYW5kX2lkOiAwLFxyXG5cdFx0XHRicmFuZF9uYW1lOiAnJyxcclxuXHRcdFx0aXRlbV9pZDogMCxcclxuXHRcdFx0aXRlbV9uYW1lOiAnJyxcclxuXHRcdFx0Y2Fsb3JpZXM6IDAsXHJcblx0XHRcdGRhdGU6IG51bGxcclxuXHRcdH1cclxuXHR9KTtcclxufSkoKTsiLCIvKmdsb2JhbCBCYWNrYm9uZSAqL1xyXG52YXIgYXBwID0gYXBwIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uICgpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblxyXG5cdC8vIFNlYXJjaCBDb2xsZWN0aW9uXHJcblx0Ly8gLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdC8vIFRoZSBjb2xsZWN0aW9uIG9mIHNlYXJjaCByZXN1bHRzXHJcblx0dmFyIFNlYXJjaEl0ZW1zQ29sbGVjdGlvbiA9IEJhY2tib25lLkNvbGxlY3Rpb24uZXh0ZW5kKHtcclxuXHJcblx0XHQvLyBSZWZlcmVuY2UgdG8gdGhpcyBjb2xsZWN0aW9uJ3MgbW9kZWwuXHJcblx0XHRtb2RlbDogYXBwLlNlYXJjaEl0ZW1Nb2RlbCxcclxuXHJcblx0XHQvLyBTYXZlIGFsbCBvZiB0aGUgZm91bmQgaXRlbXMgdW5kZXIgdGhlICdzZWFyY2hjYWxvcmllcy1iYWNrYm9uZScgbmFtZXNwYWNlLlxyXG5cdFx0bG9jYWxTdG9yYWdlOiBuZXcgQmFja2JvbmUuTG9jYWxTdG9yYWdlKCdzZWFyY2hjYWxvcmllcy1iYWNrYm9uZScpXHJcblxyXG5cdH0pO1xyXG5cclxuXHQvLyBDcmVhdGUgb3VyIGdsb2JhbCBjb2xsZWN0aW9uIG9mIHNlYXJjaCByZXN1bHRzLlxyXG5cdGFwcC5zZWFyY2hJdGVtc0NvbGxlY3Rpb24gPSBuZXcgU2VhcmNoSXRlbXNDb2xsZWN0aW9uKCk7XHJcbn0pKCk7IiwiLypnbG9iYWwgQmFja2JvbmUgKi9cclxudmFyIGFwcCA9IGFwcCB8fCB7fTtcclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cclxuXHQvLyBDaG9zZW4gcHJvZHVjdHMgQ29sbGVjdGlvblxyXG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdC8vIFRoZSBjb2xsZWN0aW9uIG9mIGNob3NlbiBwcm9kdWNzdFxyXG5cdHZhciBSZXN1bHRzSXRlbXNDb2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQoe1xyXG5cclxuXHRcdC8vIFJlZmVyZW5jZSB0byB0aGlzIGNvbGxlY3Rpb24ncyBtb2RlbC5cclxuXHRcdG1vZGVsOiBhcHAuUmVzdWx0c0l0ZW1Nb2RlbCxcclxuXHJcblx0XHQvLyBTYXZlIGFsbCBvZiB0aGUgY2hvc2VuIGl0ZW1zIHVuZGVyIHRoZSAncmVzdWx0c2NhbG9yaWVzLWJhY2tib25lJyBuYW1lc3BhY2UuXHJcblx0XHRsb2NhbFN0b3JhZ2U6IG5ldyBCYWNrYm9uZS5Mb2NhbFN0b3JhZ2UoJ3Jlc3VsdHNjYWxvcmllcy1iYWNrYm9uZScpLFxyXG5cclxuXHRcdC8vIENhbGN1YXRlIHRvdGFsIG51bWJlciBvZiBjYWxvcmllcyBmb3IgY2hvc2VuIHByb2R1Y3RzLlxyXG5cdFx0Y2FsY3VsYXRlVG90YWw6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0dmFyIHN1bSA9IDA7XHJcblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbihtb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgc3VtICs9IG1vZGVsLmdldCgnY2Fsb3JpZXMnKTtcclxuICAgICAgICAgICAgfSk7XHJcblx0XHRcdHJldHVybiBzdW07XHJcblx0XHR9LFxyXG5cdH0pO1xyXG5cclxuXHQvLyBDcmVhdGUgb3VyIGdsb2JhbCBjb2xsZWN0aW9uIG9mIGNob3NlbiBwcm9kdWN0cy5cclxuXHRhcHAucmVzdWx0c0l0ZW1zQ29sbGVjdGlvbiA9IG5ldyBSZXN1bHRzSXRlbXNDb2xsZWN0aW9uKCk7XHJcbn0pKCk7IiwiLypnbG9iYWwgQmFja2JvbmUsIGpRdWVyeSwgXywgRU5URVJfS0VZLCBFU0NfS0VZICovXHJcbnZhciBhcHAgPSBhcHAgfHwge307XHJcblxyXG4oZnVuY3Rpb24gKCQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblxyXG5cdC8vIFNlYXJjaCBJdGVtIFZpZXdcclxuXHQvLyAtLS0tLS0tLS0tLS0tLVxyXG5cclxuXHQvLyBUaGUgRE9NIGVsZW1lbnQgZm9yIGEgc2VhcmNoIGl0ZW0uLi5cclxuXHRhcHAuU2VhcmNoSXRlbVZpZXcgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XHJcblx0XHQvLy4uLiBpcyBhIGxpc3QgdGFnLlxyXG5cdFx0dGFnTmFtZTogICdsaScsXHJcblxyXG5cdFx0Ly8gQ2FjaGUgdGhlIHRlbXBsYXRlIGZ1bmN0aW9uIGZvciBhIHNpbmdsZSBpdGVtLlxyXG5cdFx0dGVtcGxhdGU6IF8udGVtcGxhdGUoJCgnI3NlYXJjaGl0ZW0tdGVtcGxhdGUnKS5odG1sKCkpLFxyXG5cclxuXHRcdC8vIFRoZSBET00gZXZlbnRzIHNwZWNpZmljIHRvIGFuIGl0ZW0uXHJcblx0XHRldmVudHM6IHtcclxuXHRcdFx0J2NsaWNrIC52aWV3JzogJ2FkZFByb2R1Y3QnIC8vIGlmIHNlYXJjaCBpdGVtIGlzIGNsaWNrZWQgaXQgc2hvdWxkIGJlIGFkZGVkIHRvIHByb2R1Y3QgbGlzdFxyXG5cdFx0fSxcclxuXHJcblx0XHQvLyBSZS1yZW5kZXIgdGhlIHRoZSBzZWFyY2ggaXRlbS5cclxuXHRcdHJlbmRlcjogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0aGlzLiRlbC5odG1sKHRoaXMudGVtcGxhdGUodGhpcy5tb2RlbC50b0pTT04oKSkpO1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH0sXHJcblxyXG5cdFx0Ly8gQWRkIGNsaWNrZWQgc2VhcmNoIGl0ZW0gdG8gcHJvZHVjdCBsaXN0IChjb2xsZWN0aW9uKSBhbmQgY2xlYXIgc2VhcmNoIHJlc3VsdHNcclxuXHRcdGFkZFByb2R1Y3Q6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0YXBwLnJlc3VsdHNJdGVtc0NvbGxlY3Rpb24uY3JlYXRlKHtcclxuXHRcdFx0XHRpdGVtX2lkOiB0aGlzLm1vZGVsLmdldCgnaXRlbV9pZCcpLFxyXG5cdFx0XHRcdGl0ZW1fbmFtZTogdGhpcy5tb2RlbC5nZXQoJ2l0ZW1fbmFtZScpLFxyXG5cdFx0XHRcdGJyYW5kX2lkOiB0aGlzLm1vZGVsLmdldCgnYnJhbmRfaWQnKSxcclxuXHRcdFx0XHRicmFuZF9uYW1lOiB0aGlzLm1vZGVsLmdldCgnYnJhbmRfbmFtZScpLFxyXG5cdFx0XHRcdGNhbG9yaWVzOiB0aGlzLm1vZGVsLmdldCgnY2Fsb3JpZXMnKSxcclxuXHRcdFx0XHRkYXRlOiB0aGlzLm1vZGVsLmdldCgnZGF0ZScpXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRhcHAuc2VhcmNoSXRlbXNDb2xsZWN0aW9uLnJlc2V0KCk7XHJcblx0XHR9XHJcblxyXG5cdH0pO1xyXG59KShqUXVlcnkpOyIsIi8qZ2xvYmFsIEJhY2tib25lLCBqUXVlcnksIF8sIEVOVEVSX0tFWSwgRVNDX0tFWSAqL1xyXG52YXIgYXBwID0gYXBwIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uICgkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cclxuXHQvLyBQcm9kdWN0IEl0ZW0gVmlld1xyXG5cdC8vIC0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdC8vIFRoZSBET00gZWxlbWVudCBmb3IgYSBwcm9kdWN0IGl0ZW0uLi5cclxuXHRhcHAuUmVzdWx0c0l0ZW1WaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xyXG5cdFx0Ly8uLi4gaXMgYSBsaXN0IHRhZy5cclxuXHRcdHRhZ05hbWU6ICAnbGknLFxyXG5cclxuXHRcdC8vIENhY2hlIHRoZSB0ZW1wbGF0ZSBmdW5jdGlvbiBmb3IgYSBzaW5nbGUgcHJvZHVjdCBpdGVtLlxyXG5cdFx0dGVtcGxhdGU6IF8udGVtcGxhdGUoJCgnI3Byb2R1Y3RpdGVtLXRlbXBsYXRlJykuaHRtbCgpKSxcclxuXHJcblx0XHQvLyBUaGUgRE9NIGV2ZW50cyBzcGVjaWZpYyB0byBhbiBpdGVtLlxyXG5cdFx0ZXZlbnRzOiB7XHJcblx0XHRcdCdjbGljayAuZGVzdHJveSc6ICdjbGVhcicsIC8vIGlmIHJlbW92ZSBidXR0b24gaXMgY2xpY2tlZCAtIHJlbW92ZSBpdGVtIGZyb20gdGhlIGxpc3QgYW5kIGNvbGxlY3Rpb25cclxuXHRcdH0sXHJcblxyXG5cdFx0Ly8gVGhlIFJlc3VsdHNJdGVtVmlldyBsaXN0ZW5zIGZvciBjaGFuZ2VzIHRvIGl0cyBtb2RlbCAoZGVzdHJveSBldmVudCkuXHJcblx0XHRpbml0aWFsaXplOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgJ2Rlc3Ryb3knLCB0aGlzLnJlbW92ZSk7XHJcblx0XHR9LFxyXG5cclxuXHRcdC8vIFJlLXJlbmRlciB0aGUgdGhlIHByb2R1Y3QgaXRlbS5cclxuXHRcdHJlbmRlcjogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0aGlzLiRlbC5odG1sKHRoaXMudGVtcGxhdGUodGhpcy5tb2RlbC50b0pTT04oKSkpO1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH0sXHJcblxyXG5cdFx0Ly8gUmVtb3ZlIHRoZSBpdGVtLCBkZXN0cm95IHRoZSBtb2RlbCBmcm9tICpsb2NhbFN0b3JhZ2UqIGFuZCBkZWxldGUgaXRzIHZpZXcuXHJcblx0XHRjbGVhcjogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0aGlzLm1vZGVsLmRlc3Ryb3koKTtcclxuXHRcdH1cclxuXHJcblx0fSk7XHJcbn0pKGpRdWVyeSk7XHJcbiIsIi8qZ2xvYmFsIEJhY2tib25lLCBqUXVlcnksIF8sIEVOVEVSX0tFWSAqL1xyXG52YXIgYXBwID0gYXBwIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uICgkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cclxuXHQvLyBUaGUgU2VhcmNoIFZpZXdcclxuXHQvLyAtLS0tLS0tLS0tLS0tLS1cclxuXHJcblx0Ly8gT3VyIG92ZXJhbGwgU2VhcmNoVmlldyBpcyB0aGUgdG9wLWxldmVsIHBpZWNlIG9mIHNlYXJjaCBVSS5cclxuXHRhcHAuU2VhcmNoVmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcclxuXHJcblx0ICAgIGVsOiAkKFwiI3NlYXJjaFwiKSwgLy8gRE9NIGVsZW1lbnRcclxuXHJcblx0ICAgIC8vIFRoZSBET00gZXZlbnQgc3BlY2lmaWMgZm9yIHRoZSBzZWFyY2ggdmlld1xyXG5cdCAgICBldmVudHM6IHtcclxuXHQgICAgICAgICdrZXl1cCAjbmV3LXNlYXJjaCc6ICdrZXlQcmVzc2VkSW5TZWFyY2gnIC8vIHNlYXJjaCBlbnRlcmVkIHF1ZXJ5IGlmIEVOVEVSIGlzIHByZXNzZWQgaW4gc2VhcmNoIGlucHV0XHJcblx0ICAgIH0sXHJcblxyXG5cdCAgICAvLyBBdCBpbml0aWFsaXphdGlvbiB3ZSBiaW5kIHRvIHRoZSByZWxldmFudCBldmVudHMgb24gdGhlIGBzZWFyY2hJdGVtc0NvbGxlY3Rpb25gXHJcblx0XHQvLyBjb2xsZWN0aW9uLCB3aGVuIGl0ZW1zIGFyZSBhZGRlZCBvciBjaGFuZ2VkLlxyXG5cdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0aGlzLiRzZWFyY2ggPSAkKCcjbmV3LXNlYXJjaCcpO1xyXG5cdFx0XHR0aGlzLiRzZWFyY2hNYWluID0gdGhpcy4kKCcjc2VhcmNoTWFpbicpO1xyXG5cdFx0XHR0aGlzLiRzZWFyY2hSZXN1bHRzID0gdGhpcy4kKCcjc2VhcmNoUmVzdWx0cycpO1xyXG5cdFx0XHR0aGlzLiRsaXN0ID0gJCgnI3NlYXJjaC1saXN0Jyk7XHJcblx0XHRcdHRoaXMuJGxvYWRpbmcgPSAkKCcjbG9hZGluZycpO1xyXG5cclxuXHRcdFx0dGhpcy5saXN0ZW5UbyhhcHAuc2VhcmNoSXRlbXNDb2xsZWN0aW9uLCAnYWRkJywgdGhpcy5hZGRPbmUpO1xyXG5cdFx0XHR0aGlzLmxpc3RlblRvKGFwcC5zZWFyY2hJdGVtc0NvbGxlY3Rpb24sICdyZXNldCcsIHRoaXMuYWRkQWxsKTtcclxuXHRcdFx0dGhpcy5saXN0ZW5UbyhhcHAuc2VhcmNoSXRlbXNDb2xsZWN0aW9uLCAnYWxsJywgdGhpcy5yZW5kZXIpO1xyXG5cdFx0fSxcclxuXHJcblx0XHQvLyBSZS1yZW5kZXJpbmcgdGhlIFNlYXJjaFZpZXcganVzdCBtZWFucyBzaG93L2hpZGUgcmVzdWx0cyBvZiB0aGUgc2VhcmNoXHJcblx0XHRyZW5kZXI6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0aWYgKGFwcC5zZWFyY2hJdGVtc0NvbGxlY3Rpb24ubGVuZ3RoKSB7XHJcblx0XHRcdFx0dGhpcy4kc2VhcmNoUmVzdWx0cy5zaG93KCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy4kc2VhcmNoUmVzdWx0cy5oaWRlKCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblxyXG5cdFx0Ly8gQWRkIGEgc2luZ2xlIHNlYXJjaCBpdGVtIHRvIHRoZSBsaXN0IGJ5IGNyZWF0aW5nIGEgdmlldyBmb3IgaXQsIGFuZFxyXG5cdFx0Ly8gYXBwZW5kaW5nIGl0cyBlbGVtZW50IHRvIHRoZSBgPHVsPmAuXHJcblx0XHRhZGRPbmU6IGZ1bmN0aW9uIChpdGVtKSB7XHJcblx0XHRcdHZhciB2aWV3ID0gbmV3IGFwcC5TZWFyY2hJdGVtVmlldyh7IG1vZGVsOiBpdGVtIH0pO1xyXG5cdFx0XHR0aGlzLiRsaXN0LmFwcGVuZCh2aWV3LnJlbmRlcigpLmVsKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0Ly8gQWRkIGFsbCBpdGVtcyBpbiB0aGUgJ3NlYXJjaEl0ZW1zQ29sbGVjdGlvbicgY29sbGVjdGlvbiBhdCBvbmNlLlxyXG5cdFx0YWRkQWxsOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHRoaXMuJGxpc3QuaHRtbCgnJyk7XHJcblx0XHRcdGFwcC5zZWFyY2hJdGVtc0NvbGxlY3Rpb24uZWFjaCh0aGlzLmFkZE9uZSwgdGhpcyk7XHJcblx0XHR9LFxyXG5cclxuXHRcdC8vIFF1ZXJ5IHNlYXJjaCByZXN1bHRzIHZpYSBBUEkgYW5kIGNyZWF0ZSBuZXcgc2VhcmNoIG1vZGVscyBhY2NvcmRpbmcgdG8gcmVjZWl2ZWQgcmVzcG9uc2UuXHJcblx0XHRzZWFyY2hQcm9kdWN0czogZnVuY3Rpb24gKGUpIHtcclxuXHJcblx0XHRcdHZhciBzZWxmID0gdGhpcztcclxuXHRcdFx0Ly8gU2hvdyAnTG9hZGluZy4uLicgbm90aWZpY2F0aW9uXHJcblx0XHQgICAgc2VsZi4kc2VhcmNoUmVzdWx0cy5zaG93KCk7XHJcblx0XHQgICAgc2VsZi4kbG9hZGluZy5zaG93KCk7XHJcblxyXG5cdFx0XHR2YXIgdXJsID0gXCJodHRwczovL2FwaS5udXRyaXRpb25peC5jb20vdjFfMS9zZWFyY2gvXCIgKyBlICsgXCI/cmVzdWx0cz0wJTNBMjAmY2FsX21pbj0wJmNhbF9tYXg9MjAmZmllbGRzPWl0ZW1fbmFtZSUyQ2JyYW5kX25hbWUlMkNpdGVtX2lkJTJDYnJhbmRfaWQlMkNuZl9jYWxvcmllcyZhcHBJZD05ZDMzNDNkNyZhcHBLZXk9NDI4M2NiYzAzZGE1MzJhNDlhZDU4ZTAwNDhlOTQxOGZcIjtcclxuXHRcdFx0JC5hamF4KHtcclxuXHRcdCAgICAgICAgdXJsOiB1cmwsXHJcblx0XHQgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHQgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcblx0XHQgICAgICAgIFx0dmFyIHByQXJyYXkgPSByZXNwb25zZS5oaXRzO1xyXG5cdFx0ICAgICAgICBcdC8vIElmIHNlYXJjaCByZXR1cm4gcmVzdWx0c1xyXG5cdFx0ICAgICAgICBcdGlmIChwckFycmF5Lmxlbmd0aCkge1xyXG5cdFx0XHQgICAgICAgIFx0Zm9yICh2YXIgaXRlbSA9IDA7IGl0ZW0gPCBwckFycmF5Lmxlbmd0aDsgaXRlbSsrKSB7XHJcblx0XHRcdFx0XHRcdFx0YXBwLnNlYXJjaEl0ZW1zQ29sbGVjdGlvbi5jcmVhdGUoe1xyXG5cdFx0XHRcdFx0XHRcdFx0YnJhbmRfaWQ6IHByQXJyYXlbaXRlbV0uZmllbGRzLmJyYW5kX2lkLFxyXG5cdFx0XHQgICAgICAgIFx0XHRcdGJyYW5kX25hbWU6IHByQXJyYXlbaXRlbV0uZmllbGRzLmJyYW5kX25hbWUsXHJcblx0XHRcdCAgICAgICAgXHRcdFx0aXRlbV9pZDogcHJBcnJheVtpdGVtXS5maWVsZHMuaXRlbV9pZCxcclxuXHRcdFx0ICAgICAgICBcdFx0XHRpdGVtX25hbWU6IHByQXJyYXlbaXRlbV0uZmllbGRzLml0ZW1fbmFtZSxcclxuXHRcdFx0ICAgICAgICBcdFx0XHRjYWxvcmllczogcHJBcnJheVtpdGVtXS5maWVsZHMubmZfY2Fsb3JpZXMsXHJcblx0XHRcdCAgICAgICAgXHRcdFx0ZGF0ZTogRGF0ZS5ub3coKVxyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdC8vIEhpZGUgJ0xvYWRpbmcuLi4nIG5vdGlmaWNhdGlvbiB3aGVuIGV2ZXJ5dGhpbmcgaXMgbG9hZGVkXHJcblx0XHRcdFx0XHRcdHNlbGYuJGxvYWRpbmcuaGlkZSgpO1xyXG5cdFx0XHRcdFx0Ly8gRWxzZSBpZiBzZWFyY2ggZG9uJ3QgZmluZCBhbnl0aGluZ1xyXG5cdFx0ICAgICAgICBcdH0gZWxzZSB7XHJcblx0XHQgICAgICAgIFx0XHQvLyBIaWRlICdMb2FkaW5nLi4uJyBub3RpZmljYXRpb24gd2hlbiBldmVyeXRoaW5nIGlzIGxvYWRlZFxyXG5cdFx0ICAgICAgICBcdFx0c2VsZi4kbG9hZGluZy5oaWRlKCk7XHJcblx0XHQgICAgICAgIFx0XHQvLyBTaG93IG5vdGlmaWNhdGlvbiB0aGF0IG5vdGhpbmcgaXMgZm91bmRcclxuXHRcdCAgICAgICAgXHRcdHNlbGYuJHNlYXJjaFJlc3VsdHMuc2hvdygpO1xyXG5cdFx0ICAgICAgICBcdFx0c2VsZi4kbGlzdC5hcHBlbmQoJzxsaT48ZGl2IGNsYXNzPVxcJ3ZpZXdcXCc+PGxhYmVsIGlkPVwicHJvZHVjdFwiPk5vIHJlc3VsdHMgZm9yIHRoaXMgcXVlcnkuIFRyeSBhZ2FpbiwgcGxlYXNlLjwvbGFiZWw+PC9kaXY+PC9saT4nKTtcclxuXHRcdCAgICAgICAgXHR9XHJcblx0XHQgICAgICAgIH0sXHJcblx0XHQgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHtcclxuXHRcdCAgICAgICAgXHQvLyBhbGVydCBpZiBhamF4IHJlcXVlc3Qgd2FzIG5vdCBleGVjdXRlZCBjb3JyZWN0bHlcclxuXHRcdFx0ICAgICAgICBhbGVydCh4aHIuc3RhdHVzICsgJyBmYWlsZWQgdG8gZ2V0IE51dHJpdGlvbml4IHJlc291cmNlcyBmb3Igc2VhcmNoIHF1ZXJ5ICcgKyBlICsgJ1xcblVybCByZXF1ZXN0ZWQ6IFxcbicgKyB1cmwpO1xyXG5cdFx0XHQgICAgfVxyXG5cdFx0XHR9KTtcclxuXHRcdH0sXHJcblxyXG5cdFx0Ly8gSGFuZGxlIGtleXVwIGV2ZW50IGZvciBFTlRFUiBvciBFU0Mga2V5c1xyXG5cdCAgICBrZXlQcmVzc2VkSW5TZWFyY2g6IGZ1bmN0aW9uIChlKSB7XHJcblx0ICAgIFx0dmFyIHNlYXJjaFF1ZXJ5ID0gdGhpcy4kc2VhcmNoLnZhbCgpLnRyaW0oKTtcclxuXHQgICAgXHQvLyBSZXF1ZXN0IHNlYXJjaCByZXN1bHRzIHZpYSBBUEkgaWYgRU5FVEVSIGlzIHByZXNzZWQgaW4gc2VhcmNoIGlucHV0IGFuZCBzZWFyY2ggcXVlcnkgaXMgbm90IGVtcHR5XHJcblx0ICAgICAgICBpZiAoZS5rZXlDb2RlID09PSBFTlRFUl9LRVkgJiYgc2VhcmNoUXVlcnkpIHtcclxuXHQgICAgICAgIFx0dGhpcy5zZWFyY2hQcm9kdWN0cyhzZWFyY2hRdWVyeSk7XHJcblx0ICAgICAgICBcdHRoaXMuJHNlYXJjaC52YWwoJycpO1xyXG5cdCAgICAgICBcdC8vIEVsc2UgY2xlYXIgc2VhcmNoIGlucHV0IGlmIEVTQyBrZXkgaXMgcHJlc3NlZCBhbmQgc2VhcmNoIHF1ZXJ5IGlzIG5vdCBlbXB0eVxyXG5cdFx0XHR9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gRVNDX0tFWSAmJiBzZWFyY2hRdWVyeSkge1xyXG5cdFx0XHRcdHRoaXMuJHNlYXJjaC52YWwoJycpO1xyXG5cdFx0XHR9XHJcblx0ICAgIH1cclxuXHJcblx0fSk7XHJcbn0pKGpRdWVyeSk7XHJcbiIsIi8qZ2xvYmFsIEJhY2tib25lLCBqUXVlcnksIF8sIEVOVEVSX0tFWSAqL1xyXG52YXIgYXBwID0gYXBwIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uICgkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cclxuXHQvLyBUaGUgUHJvZHVjdHMgTGlzdCBWaWV3XHJcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuXHQvLyBPdXIgb3ZlcmFsbCBSZXN1bHRzVmlldyBpcyB0aGUgdG9wLWxldmVsIHBpZWNlIG9mIHByb2R1Y3RzIGxpc3QgVUkuXHJcblx0YXBwLlJlc3VsdHNWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xyXG5cclxuXHQgICAgZWw6ICQoXCIjbGlzdFwiKSwgLy8gRE9NIGVsZW1lbnRcclxuXHJcblx0XHQvLyBBdCBpbml0aWFsaXphdGlvbiB3ZSBiaW5kIHRvIHRoZSByZWxldmFudCBldmVudHMgb24gdGhlIGByZXN1bHRzSXRlbXNDb2xsZWN0aW9uYFxyXG5cdFx0Ly8gY29sbGVjdGlvbiwgd2hlbiBpdGVtcyBhcmUgYWRkZWQgb3IgY2hhbmdlZC4gS2ljayB0aGluZ3Mgb2ZmIGJ5XHJcblx0XHQvLyBsb2FkaW5nIGFueSBwcmVleGlzdGluZyBwcm9kdWN0cyB0aGF0IG1pZ2h0IGJlIHNhdmVkIGluICpsb2NhbFN0b3JhZ2UqLlxyXG5cdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0aGlzLiRsaXN0ID0gJCgnI3Byb2R1Y3RzLWxpc3QnKTtcclxuXHRcdFx0dGhpcy4kbWFpbiA9ICQoJyNtYWluJyk7XHJcblx0XHRcdHRoaXMuJHRvdGFsID0gJCgnI3RvdGFsJyk7XHJcblx0XHRcdHRoaXMuJHRvdGFsQ291bnQgPSAkKCcudG90YWxDb3VudCcpO1xyXG5cclxuXHRcdFx0dGhpcy5saXN0ZW5UbyhhcHAucmVzdWx0c0l0ZW1zQ29sbGVjdGlvbiwgJ2FkZCcsIHRoaXMuYWRkT25lKTtcclxuXHRcdFx0dGhpcy5saXN0ZW5UbyhhcHAucmVzdWx0c0l0ZW1zQ29sbGVjdGlvbiwgJ3Jlc2V0JywgdGhpcy5hZGRBbGwpO1xyXG5cdFx0XHR0aGlzLmxpc3RlblRvKGFwcC5yZXN1bHRzSXRlbXNDb2xsZWN0aW9uLCAnYWxsJywgdGhpcy5yZW5kZXIpO1xyXG5cdFx0XHR0aGlzLmxpc3RlblRvKGFwcC5yZXN1bHRzSXRlbXNDb2xsZWN0aW9uLCAncmVtb3ZlJywgdGhpcy5yZW5kZXIpO1xyXG5cclxuXHRcdFx0YXBwLnJlc3VsdHNJdGVtc0NvbGxlY3Rpb24uZmV0Y2goe3Jlc2V0OiB0cnVlfSk7XHJcblx0XHR9LFxyXG5cclxuXHRcdC8vIFJlLXJlbmRlcmluZyBwcm9kdWN0IGxpc3QganVzdCBtZWFucyByZWZyZXNoaW5nIHRoZSBzdGF0aXN0aWNzIG9mIHRvdGFsIGNhbG9yaWVzXHJcblx0XHRyZW5kZXI6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0Ly8gQ2FsY3VsYXRlIHRvdGFsIGNhbG9yaWVzIGlmIHByb2R1Y3QgbGlzdCBpcyBub3QgZW1wdHlcclxuXHRcdFx0aWYgKGFwcC5yZXN1bHRzSXRlbXNDb2xsZWN0aW9uLmxlbmd0aCkge1xyXG5cdFx0XHRcdHRoaXMuJHRvdGFsQ291bnQuaHRtbChhcHAucmVzdWx0c0l0ZW1zQ29sbGVjdGlvbi5jYWxjdWxhdGVUb3RhbCgpKTtcclxuXHRcdFx0XHR0aGlzLiRtYWluLnNob3coKTtcclxuXHRcdFx0XHR0aGlzLiR0b3RhbC5zaG93KCk7XHJcblx0XHRcdC8vIEhpZGUgdG90YWwgc3RhdGlzdGljcyBpZiBwcm9kdWN0IGxpc3QgaWYgZW1wdHlcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0aGlzLiRtYWluLmhpZGUoKTtcclxuXHRcdFx0XHR0aGlzLiR0b3RhbC5oaWRlKCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblxyXG5cdFx0Ly8gQWRkIGEgc2luZ2xlIHByb2R1Y3QgaXRlbSB0byB0aGUgbGlzdCBieSBjcmVhdGluZyBhIHZpZXcgZm9yIGl0LCBhbmRcclxuXHRcdC8vIGFwcGVuZGluZyBpdHMgZWxlbWVudCB0byB0aGUgYDx1bD5gLlxyXG5cdFx0YWRkT25lOiBmdW5jdGlvbiAoaXRlbSkge1xyXG5cdFx0XHR2YXIgdmlldyA9IG5ldyBhcHAuUmVzdWx0c0l0ZW1WaWV3KHsgbW9kZWw6IGl0ZW0gfSk7XHJcblx0XHRcdHRoaXMuJGxpc3QuYXBwZW5kKHZpZXcucmVuZGVyKCkuZWwpO1xyXG5cdFx0fSxcclxuXHJcblx0XHQvLyBBZGQgYWxsIGl0ZW1zIGluIHRoZSAncmVzdWx0c0l0ZW1zQ29sbGVjdGlvbicgY29sbGVjdGlvbiBhdCBvbmNlLlxyXG5cdFx0YWRkQWxsOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHRoaXMuJGxpc3QuaHRtbCgnJyk7XHJcblx0XHRcdGFwcC5yZXN1bHRzSXRlbXNDb2xsZWN0aW9uLmVhY2godGhpcy5hZGRPbmUsIHRoaXMpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59KShqUXVlcnkpO1xyXG4iLG51bGwsIi8qZ2xvYmFsICQgKi9cclxuLypqc2hpbnQgdW51c2VkOmZhbHNlICovXHJcbnZhciBhcHAgPSBhcHAgfHwge307XHJcbnZhciBFTlRFUl9LRVkgPSAxMztcclxudmFyIEVTQ19LRVkgPSAyNztcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHJcblx0Ly8ga2ljayB0aGluZ3Mgb2ZmIGJ5IGNyZWF0aW5nIHRoZSBgQXBwYFxyXG5cdG5ldyBhcHAuU2VhcmNoVmlldygpO1xyXG5cdG5ldyBhcHAuUmVzdWx0c1ZpZXcoKTtcclxufSk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
